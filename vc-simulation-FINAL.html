<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venture Capital Simulation - PayFlow Analysis - Cloverpath</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #2d8659;
            --light-green: #7cb342;
            --dark-green: #1b5e3a;
            --light-green-dark: #5a9c2e;
            --bg-light: #f5f9f7;
            --text-dark: #1a1a1a;
            --text-gray: #666;
            --border-color: #e0e0e0;
            --white: #ffffff;
            --yellow: #ffc107;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            color: var(--white);
            padding: 40px 20px;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .startup-banner {
            background: linear-gradient(135deg, #5a9c2e 0%, #7cb342 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .startup-banner h2 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .startup-banner p {
            opacity: 0.9;
        }

        .progress-container {
            background: var(--white);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-green) 0%, var(--light-green) 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-gray);
        }

        .section {
            background: var(--white);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            border-left: 4px solid var(--primary-green);
            padding-left: 20px;
            margin-bottom: 25px;
        }

        .section-header h2 {
            color: var(--primary-green);
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .section-header p {
            color: var(--text-gray);
            font-size: 1rem;
        }

        .materials-box {
            background: #f0fdf4;
            border: 2px solid #7cb342;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .materials-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .materials-header h3 {
            color: #5a9c2e;
            font-size: 1.2rem;
        }

        .materials-toggle {
            background: #7cb342;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .materials-content {
            margin-top: 15px;
            display: none;
        }

        .materials-content.expanded {
            display: block;
        }

        .materials-content h4 {
            color: #5a9c2e;
            margin-top: 15px;
            margin-bottom: 8px;
        }

        .materials-content p, .materials-content ul {
            color: var(--text-dark);
            margin-bottom: 10px;
            line-height: 1.7;
        }

        .materials-content ul {
            margin-left: 20px;
        }

        .materials-content li {
            margin-bottom: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            background: white;
        }

        .data-table th,
        .data-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .data-table th {
            background: #5a9c2e;
            color: white;
            font-weight: 600;
        }

        .data-table tr:nth-child(even) {
            background: #f8fafc;
        }

        .highlight-box {
            background: #fef3c7;
            border-left: 4px solid var(--yellow);
            padding: 15px;
            margin: 15px 0;
        }

        .input-group {
            margin: 20px 0;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-green);
        }

        .input-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .input-hint {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-top: 5px;
            font-style: italic;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--primary-green);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--dark-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(45, 134, 89, 0.3);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--primary-green);
            border: 2px solid var(--primary-green);
        }

        .btn-secondary:hover {
            background: var(--primary-green);
            color: var(--white);
        }

        .score-card {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--light-green) 100%);
            color: var(--white);
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
        }

        .score-number {
            font-size: 4rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .score-breakdown {
            background: var(--white);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-dark);
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .score-label {
            font-weight: 600;
        }

        .score-value {
            color: var(--primary-green);
            font-weight: bold;
        }

        .feedback-box {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-green);
        }

        .feedback-box.warning {
            border-left-color: #ff9800;
            background: #fff3e0;
        }

        .feedback-box.error {
            border-left-color: #f44336;
            background: #ffebee;
        }

        .feedback-box.success {
            border-left-color: var(--light-green);
            background: #f1f8e9;
        }

        .recommendation-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 0;
        }

        .recommendation-badge.invest {
            background: #4caf50;
            color: var(--white);
        }

        .recommendation-badge.wait {
            background: #ff9800;
            color: var(--white);
        }

        .recommendation-badge.pass {
            background: #f44336;
            color: var(--white);
        }

        .table-responsive {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--white);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-green);
            color: var(--white);
            font-weight: 600;
        }

        tr:hover {
            background: var(--bg-light);
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .btn-export {
            background: var(--light-green);
            color: var(--white);
        }

        .btn-export:hover {
            background: #3d9991;
        }

        .resource-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .resource-tab {
            padding: 10px 20px;
            background: #d1fae5;
            border: 2px solid #7cb342;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .resource-tab:hover {
            background: #7cb342;
            color: white;
        }

        .quote-box {
            background: #f8fafc;
            border-left: 4px solid #7cb342;
            padding: 15px;
            margin: 10px 0;
            font-style: italic;
        }

        .tooltip-wrapper {
            position: relative;
            display: inline-block;
        }

        .tooltip-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: var(--primary-green);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 5px;
            cursor: help;
            vertical-align: middle;
        }

        .tooltip-text {
            visibility: hidden;
            width: 280px;
            background-color: var(--text-dark);
            color: white;
            text-align: left;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: normal;
            line-height: 1.4;
            
            /* Position */
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            
            /* Fade in */
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--text-dark) transparent transparent transparent;
        }

        .tooltip-wrapper:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }

            .container {
                padding: 10px;
            }

            .header {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            .header h1 {
                font-size: 1.5rem;
                margin-bottom: 8px;
            }

            .header p {
                font-size: 0.9rem;
            }

            .company-banner {
                padding: 15px;
            }

            .company-banner h2 {
                font-size: 1.3rem;
                line-height: 1.3;
                word-break: break-word;
            }

            .company-banner p {
                font-size: 0.85rem;
                line-height: 1.4;
            }

            .progress-container,
            .section,
            .quick-facts,
            .guide-box,
            .framework-box {
                padding: 15px;
                margin-bottom: 15px;
            }

            .materials-box {
                padding: 15px;
                margin-bottom: 15px;
            }

            .section-header {
                padding-left: 15px;
                margin-bottom: 20px;
            }

            .section-header h2 {
                font-size: 1.4rem;
            }

            .section-header p {
                font-size: 0.9rem;
            }

            .facts-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .fact-item {
                padding: 12px;
            }

            .fact-label {
                font-size: 0.7rem;
            }

            .fact-value {
                font-size: 1.1rem;
            }

            .guide-checklist {
                grid-template-columns: 1fr;
            }

            .materials-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .materials-header h3 {
                font-size: 1.1rem;
                min-width: 0;
                flex: none;
                width: 100%;
                word-break: break-word;
                line-height: 1.4;
            }

            .materials-toggle {
                padding: 10px 16px;
                font-size: 0.85rem;
                align-self: flex-start;
            }

            .materials-content {
                font-size: 0.9rem;
                padding: 0;
            }

            .materials-content h4 {
                font-size: 1.05rem;
                margin: 15px 0 8px 0;
            }

            .materials-content p {
                margin-bottom: 12px;
                line-height: 1.6;
            }

            .materials-content ul {
                margin-left: 15px;
            }

            .materials-content li {
                margin-bottom: 8px;
                line-height: 1.5;
            }

            .data-table {
                font-size: 0.7rem;
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .data-table th,
            .data-table td {
                padding: 8px 4px;
                font-size: 0.7rem;
            }

            .data-table th {
                white-space: nowrap;
            }

            .input-group {
                margin: 15px 0;
            }

            .input-group label {
                font-size: 0.95rem;
            }

            .input-group input,
            .input-group textarea,
            .input-group select {
                padding: 10px;
                font-size: 16px;
            }

            .input-group textarea {
                min-height: 100px;
            }

            .checkbox-item {
                padding: 12px 8px;
                align-items: flex-start;
            }

            .checkbox-item input[type="checkbox"] {
                margin-top: 2px;
                flex-shrink: 0;
            }

            .checkbox-item label {
                font-size: 0.9rem;
            }

            .button-group {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 1rem;
            }

            .tooltip-text {
                width: 200px;
                margin-left: -100px;
            }

            .tooltip-wrapper:hover .tooltip-text {
                display: none;
            }

            .tooltip-icon {
                display: none;
            }

            .resource-tabs {
                flex-direction: column;
            }

            .resource-tab {
                width: 100%;
            }

            .calc-box {
                font-size: 0.75rem;
                padding: 12px;
                word-break: break-word;
            }

            .example-box {
                padding: 15px;
                font-size: 0.9rem;
            }

            .example-good,
            .example-bad {
                padding: 10px;
                font-size: 0.85rem;
                word-break: break-word;
            }

            .highlight-box,
            .feedback-box,
            .alert-banner {
                padding: 12px 15px;
                font-size: 0.9rem;
            }

            .score-card {
                padding: 20px 15px;
            }

            .score-number {
                font-size: 3rem;
                margin: 15px 0;
            }

            .score-breakdown {
                padding: 15px;
            }

            .score-item {
                padding: 10px 0;
                font-size: 0.9rem;
            }

            .export-buttons {
                flex-direction: column;
            }

            .framework-box h4,
            .guide-box h3,
            .materials-header h3 {
                font-size: 1.1rem;
            }

            .materials-content table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }

            .example-header,
            .example-content {
                word-break: break-word;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.3rem;
            }

            .company-banner {
                padding: 12px;
            }

            .company-banner h2 {
                font-size: 1.1rem;
            }

            .company-banner p {
                font-size: 0.8rem;
            }

            .section-header h2 {
                font-size: 1.2rem;
            }

            .score-number {
                font-size: 2.5rem;
            }

            .data-table th,
            .data-table td {
                padding: 6px 3px;
                font-size: 0.65rem;
            }

            .materials-header h3 {
                font-size: 1rem;
                line-height: 1.3;
            }

            .materials-toggle {
                font-size: 0.8rem;
                padding: 8px 14px;
            }

            .materials-content h4 {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Venture Capital Simulation</h1>
            <p>Conduct comprehensive market diligence and make your investment decision</p>
        </div>

        <div class="progress-container">
            <h3>Your Progress</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span id="progressLabel">Introduction</span>
                <span id="progressPercent">0% Complete</span>
            </div>
        </div>

        <div class="startup-banner">
            <h2>PayFlow</h2>
            <p>Payment Processing Platform for Small Businesses</p>
        </div>

        <!-- Section 0: Introduction & Materials -->
        <div class="section active" id="section0">
            <div class="section-header">
                <h2>Welcome to Your VC Diligence Assignment</h2>
                <p>Review the materials and conduct your analysis</p>
            </div>

            <div class="feedback-box success">
                <h3 style="margin-bottom: 10px;">Your Mission</h3>
                <p>You are a venture capital analyst evaluating <strong>PayFlow</strong>, an early-stage FinTech startup seeking Series A funding. Your firm has provided you with comprehensive due diligence materials including financial statements, market research, competitor analysis, and customer interviews.</p>
                <p style="margin-top: 10px;"><strong>Your task:</strong> Analyze the provided materials, extract key insights, build financial models, and make an investment recommendation backed by data.</p>
            </div>

            <div class="materials-box">
                <div class="materials-header" onclick="toggleMaterials('companyOverview')">
                    <h3>Company Overview & Financials</h3>
                    <span class="materials-toggle">Click to View</span>
                </div>
                <div class="materials-content" id="companyOverview">
                    <h4>Company Background</h4>
                    <p><strong>PayFlow</strong> is a payment processing platform designed specifically for small businesses with less than 50 employees. Founded in 2021 by Sarah Chen (ex-Stripe engineer) and Marcus Rodriguez (former small business owner), PayFlow simplifies payment acceptance across multiple channels (online, in-person, mobile) with transparent pricing and integrated business tools.</p>
                    
                    <h4>Product Overview</h4>
                    <p>PayFlow offers:</p>
                    <ul>
                        <li>Unified payment processing (credit cards, ACH, digital wallets)</li>
                        <li>Point-of-sale hardware and software</li>
                        <li>Invoicing and recurring billing automation</li>
                        <li>Real-time financial dashboard and reporting</li>
                        <li>Integrated inventory management</li>
                        <li>Same-day fund deposits (vs. industry standard 2-3 days)</li>
                    </ul>

                    <h4>Current Metrics (as of Q4 2024)</h4>
                    <table class="data-table">
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Active Merchants</td>
                            <td>2,847</td>
                        </tr>
                        <tr>
                            <td>Monthly Recurring Revenue (MRR)</td>
                            <td>$427,050</td>
                        </tr>
                        <tr>
                            <td>Annual Run Rate (ARR)</td>
                            <td>$5,124,600</td>
                        </tr>
                        <tr>
                            <td>Month-over-Month Growth</td>
                            <td>18%</td>
                        </tr>
                        <tr>
                            <td>Gross Margin</td>
                            <td>68%</td>
                        </tr>
                        <tr>
                            <td>Average Revenue Per Merchant (Monthly)</td>
                            <td>$150</td>
                        </tr>
                        <tr>
                            <td>Customer Churn Rate (Monthly)</td>
                            <td>3.2%</td>
                        </tr>
                    </table>

                    <h4>Customer Acquisition Costs</h4>
                    <table class="data-table">
                        <tr>
                            <th>Channel</th>
                            <th>Cost per Acquisition</th>
                            <th>% of New Customers</th>
                        </tr>
                        <tr>
                            <td>Content Marketing / SEO</td>
                            <td>$180</td>
                            <td>35%</td>
                        </tr>
                        <tr>
                            <td>Paid Social Advertising</td>
                            <td>$320</td>
                            <td>40%</td>
                        </tr>
                        <tr>
                            <td>Referrals / Word of Mouth</td>
                            <td>$95</td>
                            <td>15%</td>
                        </tr>
                        <tr>
                            <td>Partnership Integrations</td>
                            <td>$210</td>
                            <td>10%</td>
                        </tr>
                    </table>
                    <p><strong>Blended CAC: $238</strong></p>

                    <h4>Operating Expenses (Monthly)</h4>
                    <table class="data-table">
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                        </tr>
                        <tr>
                            <td>Sales & Marketing</td>
                            <td>$185,000</td>
                        </tr>
                        <tr>
                            <td>Engineering & Product</td>
                            <td>$245,000</td>
                        </tr>
                        <tr>
                            <td>Customer Support</td>
                            <td>$78,000</td>
                        </tr>
                        <tr>
                            <td>General & Administrative</td>
                            <td>$112,000</td>
                        </tr>
                        <tr>
                            <td><strong>Total Monthly Burn</strong></td>
                            <td><strong>$620,000</strong></td>
                        </tr>
                    </table>
                    <p><strong>Current Runway:</strong> 14 months (raised $8.7M seed round, $8.68M remaining)</p>
                </div>
            </div>

            <div class="materials-box">
                <div class="materials-header" onclick="toggleMaterials('marketResearch')">
                    <h3>Market Research Report</h3>
                    <span class="materials-toggle">Click to View</span>
                </div>
                <div class="materials-content" id="marketResearch">
                    <h4>Total Addressable Market (TAM)</h4>
                    <p>The U.S. small business payment processing market is segmented as follows:</p>
                    
                    <table class="data-table">
                        <tr>
                            <th>Business Size</th>
                            <th>Number of Businesses</th>
                            <th>Avg Annual Spend</th>
                            <th>Market Size</th>
                        </tr>
                        <tr>
                            <td>1-10 employees</td>
                            <td>8.2 million</td>
                            <td>$1,450/year</td>
                            <td>$11.89B</td>
                        </tr>
                        <tr>
                            <td>11-50 employees</td>
                            <td>1.8 million</td>
                            <td>$2,850/year</td>
                            <td>$5.13B</td>
                        </tr>
                        <tr>
                            <td><strong>Total TAM</strong></td>
                            <td><strong>10 million</strong></td>
                            <td></td>
                            <td><strong>$17.02B</strong></td>
                        </tr>
                    </table>

                    <h4>Serviceable Addressable Market (SAM)</h4>
                    <p>PayFlow initially targets tech-savvy small businesses in retail, food & beverage, and professional services sectors:</p>
                    <ul>
                        <li><strong>Geographic Focus:</strong> Initially targeting major metro areas (top 50 U.S. cities)</li>
                        <li><strong>Target Segment:</strong> ~40% of total small businesses (4 million businesses)</li>
                        <li><strong>SAM Size:</strong> $6.81B</li>
                    </ul>

                    <h4>Market Growth Trends</h4>
                    <ul>
                        <li>Overall payment processing market growing at 11.2% CAGR</li>
                        <li>Digital payment adoption accelerating post-pandemic (67% growth in contactless)</li>
                        <li>Small business formation up 24% year-over-year</li>
                        <li>Shift from legacy providers to integrated solutions growing 18% annually</li>
                    </ul>

                    <div class="highlight-box">
                        <strong>Key Insight:</strong> Industry analysts project the small business payment processing market will reach $24.5B by 2027, representing a 44% growth from current levels.
                    </div>
                </div>
            </div>

            <div class="materials-box">
                <div class="materials-header" onclick="toggleMaterials('competitors')">
                    <h3>Competitor Analysis</h3>
                    <span class="materials-toggle">Click to View</span>
                </div>
                <div class="materials-content" id="competitors">
                    <h4>Direct Competitors</h4>

                    <div style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px;">
                        <h4 style="color: #5a9c2e;">Square (Block, Inc.)</h4>
                        <p><strong>Market Position:</strong> Market leader with 35% share in small business segment</p>
                        <p><strong>Pricing:</strong> 2.6% + $0.10 per transaction (card-present), 2.9% + $0.30 (online)</p>
                        <p><strong>Strengths:</strong></p>
                        <ul>
                            <li>Strong brand recognition and trust</li>
                            <li>Comprehensive ecosystem (payments, payroll, lending, POS)</li>
                            <li>Simple, transparent pricing</li>
                            <li>Easy setup and onboarding</li>
                        </ul>
                        <p><strong>Weaknesses:</strong></p>
                        <ul>
                            <li>Higher processing fees than competitors</li>
                            <li>Limited customization options</li>
                            <li>Customer service issues at scale (avg 48hr response time)</li>
                            <li>Fund hold policies frustrate merchants (2-3 day holds common)</li>
                        </ul>
                    </div>

                    <div style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px;">
                        <h4 style="color: #5a9c2e;">Stripe</h4>
                        <p><strong>Market Position:</strong> 22% market share, dominant in e-commerce/online</p>
                        <p><strong>Pricing:</strong> 2.9% + $0.30 per transaction (online), limited in-person options</p>
                        <p><strong>Strengths:</strong></p>
                        <ul>
                            <li>Developer-friendly API and integration</li>
                            <li>Powerful automation and customization</li>
                            <li>Global payment support (135+ currencies)</li>
                            <li>Advanced fraud detection</li>
                        </ul>
                        <p><strong>Weaknesses:</strong></p>
                        <ul>
                            <li>Technical complexity - requires developer resources</li>
                            <li>Weak in-person/retail POS capabilities</li>
                            <li>Overwhelming for non-technical small business owners</li>
                            <li>Limited business management tools</li>
                        </ul>
                    </div>

                    <div style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px;">
                        <h4 style="color: #5a9c2e;">PayPal/Zettle</h4>
                        <p><strong>Market Position:</strong> 18% market share, strong in online payments</p>
                        <p><strong>Pricing:</strong> 2.7% + $0.0 per transaction (card-present), 3.49% + $0.49 (online)</p>
                        <p><strong>Strengths:</strong></p>
                        <ul>
                            <li>Consumer brand awareness (PayPal accounts)</li>
                            <li>Fast checkout for PayPal users</li>
                            <li>International capabilities</li>
                            <li>Buy Now Pay Later integration (PayPal Credit)</li>
                        </ul>
                        <p><strong>Weaknesses:</strong></p>
                        <ul>
                            <li>Highest processing fees in category for online transactions</li>
                            <li>Account freezes and reserve policies</li>
                            <li>Fragmented product experience (PayPal vs. Zettle)</li>
                            <li>Poor customer service reputation</li>
                        </ul>
                    </div>

                    <div style="margin: 20px 0; padding: 15px; background: white; border-radius: 8px;">
                        <h4 style="color: #5a9c2e;">Clover (Fiserv)</h4>
                        <p><strong>Market Position:</strong> 12% market share, strong in restaurant/retail</p>
                        <p><strong>Pricing:</strong> Custom pricing (typically 2.3-2.6% + monthly fees $10-60)</p>
                        <p><strong>Strengths:</strong></p>
                        <ul>
                            <li>Robust POS hardware and software</li>
                            <li>Industry-specific solutions (restaurants, retail)</li>
                            <li>Large app marketplace</li>
                            <li>Lower transaction fees for high-volume merchants</li>
                        </ul>
                        <p><strong>Weaknesses:</strong></p>
                        <ul>
                            <li>Requires hardware purchase/lease (upfront costs $400-1,200)</li>
                            <li>Complex pricing with hidden fees</li>
                            <li>Lengthy contracts (often 3-year commitments)</li>
                            <li>Difficult to switch away from (lock-in)</li>
                        </ul>
                    </div>

                    <div class="highlight-box">
                        <strong>Competitive Gap:</strong> Analysis shows incumbent players struggle with: (1) High customer service response times, (2) Opaque or complex pricing, (3) Lengthy fund settlement periods, and (4) Poor integration between online and in-person channels. This creates opportunity for a unified, transparent, fast-settlement solution.
                    </div>
                </div>
            </div>

            <div class="materials-box">
                <div class="materials-header" onclick="toggleMaterials('interviews')">
                    <h3>Customer Interview Excerpts</h3>
                    <span class="materials-toggle">Click to View</span>
                </div>
                <div class="materials-content" id="interviews">
                    <p><strong>Note:</strong> Excerpts from 12 customer interviews with current PayFlow users (6 interviews) and target customers using competitor products (6 interviews).</p>

                    <div class="quote-box">
                        <p><strong>Maria G., Coffee Shop Owner (Current PayFlow Customer)</strong></p>
                        <p>"The biggest pain point with Square was waiting 2-3 days for my money. When you're running on thin margins and need to pay suppliers, that delay kills you. PayFlow's same-day deposits changed everything for my cash flow. I can actually plan my expenses now."</p>
                    </div>

                    <div class="quote-box">
                        <p><strong>James T., Boutique Retail Store (Current PayFlow Customer)</strong></p>
                        <p>"I tried using Stripe for my online store, but I'm not a developer. It was way too complicated. PayFlow just works - online, in-store, mobile, all in one place. And when I have questions, I get answers in hours, not days."</p>
                    </div>

                    <div class="quote-box">
                        <p><strong>David L., Consulting Firm (Competitor Customer - Using Square)</strong></p>
                        <p>"Square is fine for basic stuff, but their invoicing system is clunky. I spend way too much time on billing and following up on payments. I'd pay more for something that automates the annoying parts of getting paid."</p>
                    </div>

                    <div class="quote-box">
                        <p><strong>Rachel K., Yoga Studio (Current PayFlow Customer)</strong></p>
                        <p>"Recurring billing was a nightmare with my old processor. Half my students would have failed payments, and I'd have to chase them down. PayFlow's automated retry logic and customer notifications have reduced my failed payments by like 80%. That's real revenue I wasn't collecting before."</p>
                    </div>

                    <div class="quote-box">
                        <p><strong>Tom S., Restaurant Owner (Competitor Customer - Using Clover)</strong></p>
                        <p>"Clover locked me into a 3-year contract, and I'm stuck paying $60/month plus transaction fees. The hardware cost me $800 upfront. When I asked about switching to their new system, they wanted another $600. I feel trapped. The transaction fees are good, but everything else nickel and dimes you."</p>
                    </div>

                    <div class="quote-box">
                        <p><strong>Lisa M., E-commerce Business (Current PayFlow Customer)</strong></p>
                        <p>"I switched from PayPal because their fees were eating into my margins - 3.5% adds up fast. PayFlow is cheaper and the reporting is way better. I can see exactly what's happening with my business in real-time. The dashboard alone is worth it."</p>
                    </div>

                    <div class="highlight-box">
                        <strong>Top Pain Points Identified:</strong>
                        <ul>
                            <li><strong>Cash flow delays</strong> (mentioned in 10/12 interviews) - Multi-day settlement periods create working capital issues</li>
                            <li><strong>Complex pricing</strong> (8/12 interviews) - Hidden fees, monthly minimums, contract obligations</li>
                            <li><strong>Poor customer support</strong> (9/12 interviews) - Long response times, unhelpful support staff</li>
                            <li><strong>Fragmented tools</strong> (7/12 interviews) - Need multiple platforms for online, in-person, invoicing</li>
                            <li><strong>Billing inefficiencies</strong> (6/12 interviews) - Manual invoicing, failed recurring payments</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="nextSection()">Begin Analysis →</button>
            </div>
        </div>

        <!-- Section 1: Market Analysis -->
        <div class="section" id="section1">
            <div class="section-header">
                <h2>Market Analysis</h2>
                <p>Extract and analyze market data from the provided materials</p>
            </div>

            <div class="input-group">
                <label>1. What is the Total Addressable Market (TAM) for PayFlow? (in Billions USD)
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">TAM (Total Addressable Market) is the total revenue opportunity if PayFlow captured 100% of all potential customers in their market.</span>
                    </span>
                </label>
                <input type="number" step="0.01" id="tamValue" placeholder="Enter TAM in billions (e.g., 17.02)">
                <div class="input-hint">Refer to the Market Research Report for TAM data</div>
            </div>

            <div class="input-group">
                <label>2. What is the Serviceable Addressable Market (SAM) for PayFlow? (in Billions USD)
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">SAM (Serviceable Addressable Market) is the portion of TAM that PayFlow can realistically reach with their current business model and resources.</span>
                    </span>
                </label>
                <input type="number" step="0.01" id="samValue" placeholder="Enter SAM in billions (e.g., 6.81)">
                <div class="input-hint">Find PayFlow's target market size in the materials</div>
            </div>

            <div class="input-group">
                <label>3. What is the projected market growth rate (CAGR) for the payment processing industry?
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">CAGR (Compound Annual Growth Rate) measures the average annual growth rate of the market over time, accounting for compounding effects.</span>
                    </span>
                </label>
                <input type="number" step="0.1" id="cagr" placeholder="Enter percentage (e.g., 11.2)">
                <div class="input-hint">Look for industry growth trends in the market research section</div>
            </div>

            <div class="input-group">
                <label>4. Based on the materials, describe the key market trends driving growth in small business payment processing (150+ words)</label>
                <textarea id="marketTrends" placeholder="Discuss trends such as digital payment adoption, small business formation rates, shift from legacy providers, etc. Use specific data from the materials."></textarea>
                <div class="input-hint">Your analysis should reference specific trends mentioned in the Market Research Report</div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">Next Section →</button>
            </div>
        </div>

        <!-- Section 2: Financial Analysis -->
        <div class="section" id="section2">
            <div class="section-header">
                <h2>Financial Analysis</h2>
                <p>Calculate key metrics using PayFlow's financial data</p>
            </div>

            <div class="input-group">
                <label>1. What is PayFlow's blended Customer Acquisition Cost (CAC)? (USD)
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">CAC (Customer Acquisition Cost) is the average amount spent on sales and marketing to acquire one new customer.</span>
                    </span>
                </label>
                <input type="number" id="cac" placeholder="Enter CAC in dollars (e.g., 238)">
                <div class="input-hint">Find the blended CAC in the Company Overview section</div>
            </div>

            <div class="input-group">
                <label>2. Calculate the Customer Lifetime Value (LTV) for PayFlow
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">LTV (Lifetime Value) is the total revenue expected from one customer over their entire relationship with the company. Higher LTV relative to CAC indicates a healthier business.</span>
                    </span>
                </label>
                <div class="input-hint" style="margin-bottom: 10px;">
                    Formula: LTV = (Average Revenue Per Month × Gross Margin) / Monthly Churn Rate<br>
                    Use: ARPM = $150, Gross Margin = 68%, Monthly Churn = 3.2%
                </div>
                <input type="number" id="ltv" placeholder="Enter calculated LTV (round to nearest dollar)">
            </div>

            <div class="input-group">
                <label>3. What is the LTV:CAC ratio? (auto-calculated)</label>
                <input type="text" id="ltvCacRatio" readonly placeholder="Will calculate automatically">
            </div>

            <div class="input-group">
                <label>4. What is PayFlow's monthly burn rate? (USD)
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">Burn Rate is the amount of cash a company spends each month beyond what it earns in revenue. It indicates how fast the company is consuming its cash reserves.</span>
                    </span>
                </label>
                <input type="number" id="burnRate" placeholder="Enter monthly burn in dollars">
                <div class="input-hint">Find total monthly operating expenses in the financials</div>
            </div>

            <div class="input-group">
                <label>5. What is PayFlow's current runway in months?
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">Runway is how many months a company can continue operating before running out of money, calculated by dividing remaining cash by monthly burn rate.</span>
                    </span>
                </label>
                <input type="number" id="runway" placeholder="Enter runway in months">
                <div class="input-hint">Check the Company Overview for remaining capital and runway</div>
            </div>

            <div class="input-group">
                <label>6. Analyze PayFlow's unit economics. Are they healthy? Why or why not? (150+ words)
                    <span class="tooltip-wrapper">
                        <span class="tooltip-icon">?</span>
                        <span class="tooltip-text">Unit Economics refers to the revenues and costs associated with acquiring and serving a single customer. Healthy unit economics means you make significantly more from a customer than it costs to acquire them.</span>
                    </span>
                </label>
                <textarea id="unitEconomics" placeholder="Discuss the LTV:CAC ratio, gross margins, burn rate relative to revenue, and what these metrics indicate about the business's financial health. Use specific numbers from your calculations."></textarea>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">Next Section →</button>
            </div>
        </div>

        <!-- Section 3: Customer Insights -->
        <div class="section" id="section3">
            <div class="section-header">
                <h2>Customer Insights</h2>
                <p>Extract key findings from customer interviews</p>
            </div>

            <div class="input-group">
                <label>1. What are the top 3 customer pain points identified in the interviews? (List all 3)</label>
                <textarea id="painPoints" placeholder="List and briefly explain the three most frequently mentioned pain points from the customer interviews. Be specific."></textarea>
                <div class="input-hint">Review the Customer Interview Excerpts - some pain points are mentioned multiple times</div>
            </div>

            <div class="input-group">
                <label>2. What specific feature or capability of PayFlow do customers value most? Provide evidence from interviews.</label>
                <textarea id="keyFeature" placeholder="Identify PayFlow's most valued feature and cite specific customer quotes that demonstrate this value."></textarea>
            </div>

            <div class="input-group">
                <label>3. Based on the competitive customer interviews, what are the main weaknesses of incumbent competitors? (150+ words)</label>
                <textarea id="competitorWeaknesses" placeholder="Analyze what customers dislike about Square, Stripe, PayPal, and Clover based on the interview excerpts. Connect these weaknesses to PayFlow's value proposition."></textarea>
            </div>

            <div class="input-group">
                <label>4. What evidence from the interviews suggests customers would be willing to switch payment processors?</label>
                <textarea id="switchingEvidence" placeholder="Identify specific quotes or themes that indicate switching intent or frustration with current solutions."></textarea>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">Next Section →</button>
            </div>
        </div>

        <!-- Section 4: Competitive Analysis -->
        <div class="section" id="section4">
            <div class="section-header">
                <h2>Competitive Analysis</h2>
                <p>Evaluate PayFlow's position against competitors</p>
            </div>

            <div class="input-group">
                <label>1. Who is the market leader in small business payment processing and what is their market share?</label>
                <input type="text" id="marketLeader" placeholder="Enter company name">
                <input type="number" step="0.1" id="marketShare" placeholder="Enter market share percentage (e.g., 35)" style="margin-top: 10px;">
            </div>

            <div class="input-group">
                <label>2. Compare PayFlow's pricing to competitors. List the transaction fees for each major competitor.</label>
                <textarea id="pricingComparison" placeholder="List transaction fees for Square, Stripe, PayPal, and Clover as shown in the Competitor Analysis."></textarea>
            </div>

            <div class="input-group">
                <label>3. What is PayFlow's primary competitive advantage based on the materials? (150+ words)</label>
                <textarea id="competitiveAdvantage" placeholder="Identify PayFlow's key differentiators. Reference specific competitor weaknesses and how PayFlow addresses them. Use data from both the competitor analysis and customer interviews."></textarea>
            </div>

            <div class="input-group">
                <label>4. What are the biggest competitive threats to PayFlow's success?</label>
                <textarea id="competitiveThreats" placeholder="Analyze which competitors pose the greatest risk and why. Consider their strengths, resources, and market position."></textarea>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">Next Section →</button>
            </div>
        </div>

        <!-- Section 5: Strategic Framework -->
        <div class="section" id="section5">
            <div class="section-header">
                <h2>Strategic Framework</h2>
                <p>Develop your investment thesis and strategic analysis</p>
            </div>

            <div class="input-group">
                <label>1. Investment Thesis: Why should (or shouldn't) your firm invest in PayFlow? (200+ words)</label>
                <textarea id="thesis" placeholder="Synthesize your analysis into a clear investment thesis. Include: market opportunity, competitive positioning, financial health, customer validation, and key risks. Support with specific data from the materials."></textarea>
            </div>

            <div class="input-group">
                <label>2. What is PayFlow's primary go-to-market strategy based on the materials?</label>
                <textarea id="gtmStrategy" placeholder="Analyze PayFlow's customer acquisition channels and their effectiveness. Reference the CAC data by channel."></textarea>
            </div>

            <div class="input-group">
                <label>3. Identify and assess the top 3 risks to PayFlow's success and propose mitigation strategies (200+ words)</label>
                <textarea id="riskMitigation" placeholder="For each risk, explain: (1) What is the risk? (2) How significant is it? (3) How can it be mitigated? Be specific and data-driven."></textarea>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">Next Section →</button>
            </div>
        </div>

        <!-- Section 6: Investment Recommendation -->
        <div class="section" id="section6">
            <div class="section-header">
                <h2>Investment Recommendation</h2>
                <p>Make your final decision and justify it</p>
            </div>

            <div class="input-group">
                <label>1. Your Investment Recommendation</label>
                <select id="recommendation">
                    <option value="">-- Select Your Recommendation --</option>
                    <option value="invest">INVEST - Proceed with Series A investment</option>
                    <option value="wait">WAIT - Need more information or better metrics</option>
                    <option value="pass">PASS - Decline this opportunity</option>
                </select>
            </div>

            <div class="input-group">
                <label>2. Rationale for Your Decision (250+ words)</label>
                <textarea id="rationale" placeholder="Provide a comprehensive justification for your recommendation. Reference specific data points from: market analysis, financial metrics, customer insights, and competitive positioning. If INVEST: explain expected returns and catalysts. If WAIT: specify what information you need. If PASS: explain why the risks outweigh the opportunity."></textarea>
            </div>

            <div class="input-group">
                <label>3. If investing, what would be your key conditions or focus areas for the founding team?</label>
                <textarea id="investmentConditions" placeholder="What metrics, milestones, or strategic priorities would you want to see? Be specific."></textarea>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
                <button class="btn btn-primary" onclick="nextSection()">View Results →</button>
            </div>
        </div>

        <!-- Section 7: Results -->
        <div class="section" id="section7">
            <div class="section-header">
                <h2>Analysis Results</h2>
                <p>Your comprehensive diligence scorecard</p>
            </div>

            <div class="score-card">
                <h3>Overall Score</h3>
                <div class="score-number" id="totalScore">--</div>
                <p>Out of 100 Points</p>
                
                <div class="score-breakdown">
                    <div class="score-item">
                        <span class="score-label">Market Analysis Accuracy</span>
                        <span class="score-value" id="score1">--/20</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Financial Analysis Accuracy</span>
                        <span class="score-value" id="score2">--/25</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Customer Insights Extraction</span>
                        <span class="score-value" id="score3">--/15</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Competitive Analysis</span>
                        <span class="score-value" id="score4">--/15</span>
                    </div>
                    <div class="score-item">
                        <span class="score-label">Strategic Thinking & Synthesis</span>
                        <span class="score-value" id="score5">--/25</span>
                    </div>
                </div>
            </div>

            <div id="feedbackContainer"></div>

            <div class="export-buttons">
                <button class="btn btn-export" onclick="generateReport()">Download Detailed Report</button>
                <button class="btn btn-primary" onclick="resetSimulation()">Start New Analysis</button>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="prevSection()">← Previous</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase
        let supabaseClient;
        
        function initSupabase() {
            if (typeof window.supabase === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                script.onload = () => {
                    supabaseClient = window.supabase.createClient(
                        'https://clhuplhaejneecbyhphh.supabase.co',
                        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsaHVwbGhhZWpuZWVjYnlocGhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjY2OTI0NzMsImV4cCI6MjA0MjI2ODQ3M30.HCW1CV2BbA5DdCd_9Q_vEoMxA-NMkPtZG2qg3hJDZLo'
                    );
                    startApp();
                };
                document.head.appendChild(script);
            } else {
                supabaseClient = window.supabase.createClient(
                    'https://clhuplhaejneecbyhphh.supabase.co',
                    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsaHVwbGhhZWpuZWVjYnlocGhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjY2OTI0NzMsImV4cCI6MjA0MjI2ODQ3M30.HCW1CV2BbA5DdCd_9Q_vEoMxA-NMkPtZG2qg3hJDZLo'
                );
                startApp();
            }
        }

        function startApp() {
            getUserEmail();
            updateProgress();
        }

        let userEmail = null;

        function getUserEmail() {
            try {
                if (window.parent.$memberstackDom) {
                    window.parent.$memberstackDom.getCurrentMember()
                        .then(({ data: member }) => {
                            if (member) {
                                userEmail = member.auth.email;
                                loadProgress();
                            }
                        });
                } else if (localStorage.getItem('cloverpath_user_email')) {
                    userEmail = localStorage.getItem('cloverpath_user_email');
                    loadProgress();
                } else {
                    const urlParams = new URLSearchParams(window.location.search);
                    userEmail = urlParams.get('email');
                    if (userEmail) {
                        loadProgress();
                    }
                }
            } catch (error) {
                console.error('Error getting user email:', error);
            }
        }

        async function loadProgress() {
            if (!userEmail) return;

            try {
                const { data, error } = await supabaseClient
                    .from('simulation_progress')
                    .select('*')
                    .eq('user_email', userEmail)
                    .eq('simulation_type', 'venture_capital')
                    .single();

                if (data && data.progress_data) {
                    const savedData = data.progress_data;
                    Object.keys(savedData).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            if (element.type === 'checkbox') {
                                element.checked = savedData[key];
                            } else {
                                element.value = savedData[key];
                            }
                        }
                    });
                    
                    if (savedData.currentSection) {
                        currentSection = savedData.currentSection;
                        showSection(currentSection);
                    }
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        async function saveProgress() {
            if (!userEmail) return;

            const formData = {};
            
            document.querySelectorAll('input, textarea, select').forEach(element => {
                if (element.id) {
                    if (element.type === 'checkbox') {
                        formData[element.id] = element.checked;
                    } else {
                        formData[element.id] = element.value;
                    }
                }
            });

            formData.currentSection = currentSection;

            try {
                const { data, error } = await supabaseClient
                    .from('simulation_progress')
                    .upsert({
                        user_email: userEmail,
                        simulation_type: 'venture_capital',
                        progress_data: formData,
                        last_updated: new Date().toISOString()
                    }, {
                        onConflict: 'user_email,simulation_type'
                    });

                if (error) throw error;
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        document.addEventListener('input', () => {
            clearTimeout(window.saveTimeout);
            window.saveTimeout = setTimeout(saveProgress, 2000);
        });

        let currentSection = 0;
        const totalSections = 8;

        // Answer key for validation
        const ANSWER_KEY = {
            tam: 17.02,
            sam: 6.81,
            cagr: 11.2,
            cac: 238,
            ltv: 3188, // Calculation: (150 * 0.68) / 0.032 = 3187.5
            burnRate: 620000,
            runway: 14,
            marketLeader: "Square",
            marketShare: 35,
            requiredKeywords: {
                painPoints: ["cash flow", "delays", "settlement", "pricing", "complex", "support", "customer service", "fragmented", "tools"],
                marketTrends: ["digital payment", "adoption", "contactless", "small business", "formation", "legacy", "integrated"],
                competitiveAdvantage: ["same-day", "deposit", "settlement", "transparent", "pricing", "unified", "integration"],
                keyFeature: ["same-day", "deposit", "settlement", "cash flow"]
            }
        };

        function toggleMaterials(id) {
            const content = document.getElementById(id);
            content.classList.toggle('expanded');
        }

        // Auto-calculate LTV:CAC ratio
        document.getElementById('ltv')?.addEventListener('input', calculateRatio);
        document.getElementById('cac')?.addEventListener('input', calculateRatio);

        function calculateRatio() {
            const ltv = parseFloat(document.getElementById('ltv')?.value) || 0;
            const cac = parseFloat(document.getElementById('cac')?.value) || 0;
            
            if (cac > 0) {
                const ratio = (ltv / cac).toFixed(2);
                document.getElementById('ltvCacRatio').value = ratio + ':1';
            }
        }

        function updateProgress() {
            const progress = (currentSection / (totalSections - 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            const labels = ['Introduction', 'Market Analysis', 'Financial Analysis', 'Customer Insights', 'Competitive Analysis', 'Strategic Framework', 'Investment Decision', 'Results'];
            document.getElementById('progressLabel').textContent = labels[currentSection] || 'Section ' + currentSection;
            document.getElementById('progressPercent').textContent = Math.round(progress) + '% Complete';
        }

        function nextSection() {
            if (currentSection < totalSections - 1) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection++;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
                saveProgress();
                
                setTimeout(function() {
                    const height = document.body.scrollHeight + 100;
                    window.parent.postMessage({
                        type: 'iframe-height',
                        height: height
                    }, '*');
                }, 300);
                
                if (currentSection === totalSections - 1) {
                    calculateScore();
                }
            }
        }

        function prevSection() {
            if (currentSection > 0) {
                document.getElementById(`section${currentSection}`).classList.remove('active');
                currentSection--;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
                saveProgress();
                
                setTimeout(function() {
                    const height = document.body.scrollHeight + 100;
                    window.parent.postMessage({
                        type: 'iframe-height',
                        height: height
                    }, '*');
                }, 300);
            }
        }

        function countWords(text) {
            return text.trim().split(/\s+/).filter(w => w.length > 0).length;
        }

        function hasKeywords(text, keywords, minMatches = 2) {
            const lowerText = text.toLowerCase();
            let matches = 0;
            keywords.forEach(keyword => {
                if (lowerText.includes(keyword.toLowerCase())) {
                    matches++;
                }
            });
            return matches >= minMatches;
        }

        function calculateScore() {
            let score1 = 0, score2 = 0, score3 = 0, score4 = 0, score5 = 0;
            const feedback = [];

            // SECTION 1: Market Analysis (20 points)
            const tam = parseFloat(document.getElementById('tamValue')?.value) || 0;
            const sam = parseFloat(document.getElementById('samValue')?.value) || 0;
            const cagr = parseFloat(document.getElementById('cagr')?.value) || 0;
            const marketTrends = document.getElementById('marketTrends')?.value || '';

            // TAM accuracy (5 points)
            if (Math.abs(tam - ANSWER_KEY.tam) < 0.1) {
                score1 += 5;
            } else if (Math.abs(tam - ANSWER_KEY.tam) < 2) {
                score1 += 3;
                feedback.push({
                    type: 'warning',
                    message: `TAM is close but not exact. The correct TAM from materials is $${ANSWER_KEY.tam}B`
                });
            } else if (tam > 0) {
                score1 += 1;
                feedback.push({
                    type: 'error',
                    message: `TAM is incorrect. Review the Market Research Report. Correct answer: $${ANSWER_KEY.tam}B`
                });
            } else {
                feedback.push({
                    type: 'error',
                    message: 'TAM not provided. This is critical market data.'
                });
            }

            // SAM accuracy (5 points)
            if (Math.abs(sam - ANSWER_KEY.sam) < 0.1) {
                score1 += 5;
            } else if (Math.abs(sam - ANSWER_KEY.sam) < 1) {
                score1 += 3;
                feedback.push({
                    type: 'warning',
                    message: `SAM is close but not exact. The correct SAM from materials is $${ANSWER_KEY.sam}B`
                });
            } else if (sam > 0) {
                score1 += 1;
                feedback.push({
                    type: 'error',
                    message: `SAM is incorrect. Review PayFlow's target market in the materials. Correct answer: $${ANSWER_KEY.sam}B`
                });
            } else {
                feedback.push({
                    type: 'error',
                    message: 'SAM not provided. This defines PayFlow\'s addressable opportunity.'
                });
            }

            // CAGR accuracy (3 points)
            if (Math.abs(cagr - ANSWER_KEY.cagr) < 0.5) {
                score1 += 3;
            } else if (cagr > 0) {
                score1 += 1;
                feedback.push({
                    type: 'warning',
                    message: `CAGR is incorrect. The market research report states ${ANSWER_KEY.cagr}% CAGR.`
                });
            }

            // Market trends analysis (7 points)
            const trendsWords = countWords(marketTrends);
            if (trendsWords >= 150) {
                const hasRelevantKeywords = hasKeywords(marketTrends, ANSWER_KEY.requiredKeywords.marketTrends, 3);
                if (hasRelevantKeywords) {
                    score1 += 7;
                } else {
                    score1 += 3;
                    feedback.push({
                        type: 'warning',
                        message: 'Market trends analysis lacks key themes from the materials (digital payment adoption, small business formation, shift from legacy providers).'
                    });
                }
            } else if (trendsWords >= 75) {
                score1 += 2;
                feedback.push({
                    type: 'warning',
                    message: `Market trends analysis is too brief (${trendsWords} words). Minimum 150 words required for thorough analysis.`
                });
            } else {
                feedback.push({
                    type: 'error',
                    message: 'Market trends analysis is insufficient. Provide detailed analysis referencing materials.'
                });
            }

            // SECTION 2: Financial Analysis (25 points)
            const cac = parseFloat(document.getElementById('cac')?.value) || 0;
            const ltv = parseFloat(document.getElementById('ltv')?.value) || 0;
            const burnRate = parseFloat(document.getElementById('burnRate')?.value) || 0;
            const runway = parseFloat(document.getElementById('runway')?.value) || 0;
            const unitEconomics = document.getElementById('unitEconomics')?.value || '';

            // CAC accuracy (5 points)
            if (cac === ANSWER_KEY.cac) {
                score2 += 5;
            } else if (Math.abs(cac - ANSWER_KEY.cac) < 20) {
                score2 += 3;
                feedback.push({
                    type: 'warning',
                    message: `CAC is close but not exact. The blended CAC stated in materials is $${ANSWER_KEY.cac}.`
                });
            } else if (cac > 0) {
                score2 += 1;
                feedback.push({
                    type: 'error',
                    message: `CAC is incorrect. Check the Company Overview for blended CAC. Correct answer: $${ANSWER_KEY.cac}`
                });
            }

            // LTV calculation (8 points)
            const ltvVariance = Math.abs(ltv - ANSWER_KEY.ltv) / ANSWER_KEY.ltv;
            if (ltvVariance < 0.02) {
                score2 += 8;
            } else if (ltvVariance < 0.10) {
                score2 += 5;
                feedback.push({
                    type: 'warning',
                    message: `LTV calculation is close but check your math. Formula: (ARPM × Gross Margin) / Churn Rate = ($150 × 0.68) / 0.032 = $${ANSWER_KEY.ltv}`
                });
            } else if (ltv > 0) {
                score2 += 2;
                feedback.push({
                    type: 'error',
                    message: `LTV calculation is incorrect. Review the formula and use data from materials. Correct answer: $${ANSWER_KEY.ltv}`
                });
            }

            // Burn rate (4 points)
            if (burnRate === ANSWER_KEY.burnRate) {
                score2 += 4;
            } else if (Math.abs(burnRate - ANSWER_KEY.burnRate) < 50000) {
                score2 += 2;
                feedback.push({
                    type: 'warning',
                    message: `Burn rate is close. Check Operating Expenses table. Correct answer: $${ANSWER_KEY.burnRate.toLocaleString()}/month`
                });
            } else if (burnRate > 0) {
                score2 += 1;
                feedback.push({
                    type: 'error',
                    message: `Burn rate is incorrect. Sum all monthly operating expenses. Correct answer: $${ANSWER_KEY.burnRate.toLocaleString()}`
                });
            }

            // Runway (3 points)
            if (runway === ANSWER_KEY.runway) {
                score2 += 3;
            } else if (Math.abs(runway - ANSWER_KEY.runway) < 2) {
                score2 += 2;
            } else if (runway > 0) {
                score2 += 1;
                feedback.push({
                    type: 'error',
                    message: `Runway is incorrect. Check Company Overview. Correct answer: ${ANSWER_KEY.runway} months`
                });
            }

            // Unit economics analysis (5 points)
            const economicsWords = countWords(unitEconomics);
            if (economicsWords >= 150) {
                const ltvCacRatio = ltv / cac;
                const mentionsRatio = unitEconomics.toLowerCase().includes('ltv') || unitEconomics.toLowerCase().includes('cac');
                if (mentionsRatio && (unitEconomics.includes(ltv.toString()) || unitEconomics.includes(cac.toString()))) {
                    score2 += 5;
                } else {
                    score2 += 2;
                    feedback.push({
                        type: 'warning',
                        message: 'Unit economics analysis should reference your calculated LTV, CAC, and ratio with specific numbers.'
                    });
                }
            } else {
                score2 += 1;
                feedback.push({
                    type: 'warning',
                    message: 'Unit economics analysis needs more depth. Discuss LTV:CAC ratio, margins, burn vs revenue.'
                });
            }

            // SECTION 3: Customer Insights (15 points)
            const painPoints = document.getElementById('painPoints')?.value || '';
            const keyFeature = document.getElementById('keyFeature')?.value || '';
            const competitorWeaknesses = document.getElementById('competitorWeaknesses')?.value || '';
            const switchingEvidence = document.getElementById('switchingEvidence')?.value || '';

            // Pain points identification (5 points)
            const painPointMatches = hasKeywords(painPoints, ANSWER_KEY.requiredKeywords.painPoints, 3);
            if (painPointMatches && countWords(painPoints) >= 50) {
                score3 += 5;
            } else if (painPointMatches) {
                score3 += 3;
            } else if (countWords(painPoints) >= 30) {
                score3 += 1;
                feedback.push({
                    type: 'warning',
                    message: 'Pain points identified but missing key themes: cash flow delays, complex pricing, poor support, fragmented tools.'
                });
            }

            // Key feature identification (4 points)
            const featureMatches = hasKeywords(keyFeature, ANSWER_KEY.requiredKeywords.keyFeature, 1);
            if (featureMatches && countWords(keyFeature) >= 40) {
                score3 += 4;
            } else if (featureMatches) {
                score3 += 2;
            } else {
                score3 += 1;
                feedback.push({
                    type: 'warning',
                    message: 'Key feature answer should highlight same-day deposits based on customer quotes.'
                });
            }

            // Competitor weaknesses (4 points)
            if (countWords(competitorWeaknesses) >= 150) {
                score3 += 4;
            } else if (countWords(competitorWeaknesses) >= 75) {
                score3 += 2;
            }

            // Switching evidence (2 points)
            if (countWords(switchingEvidence) >= 30) {
                score3 += 2;
            }

            // SECTION 4: Competitive Analysis (15 points)
            const marketLeader = document.getElementById('marketLeader')?.value || '';
            const marketShare = parseFloat(document.getElementById('marketShare')?.value) || 0;
            const pricingComparison = document.getElementById('pricingComparison')?.value || '';
            const competitiveAdvantage = document.getElementById('competitiveAdvantage')?.value || '';
            const competitiveThreats = document.getElementById('competitiveThreats')?.value || '';

            // Market leader identification (4 points)
            if (marketLeader.toLowerCase().includes('square')) {
                score4 += 2;
            } else {
                feedback.push({
                    type: 'error',
                    message: 'Market leader is incorrect. Review Competitor Analysis section.'
                });
            }

            if (marketShare === ANSWER_KEY.marketShare) {
                score4 += 2;
            } else if (Math.abs(marketShare - ANSWER_KEY.marketShare) < 5) {
                score4 += 1;
            }

            // Pricing comparison (3 points)
            const mentionsMultipleCompetitors = (pricingComparison.toLowerCase().includes('square') &&
                                                  pricingComparison.toLowerCase().includes('stripe') &&
                                                  pricingComparison.toLowerCase().includes('paypal'));
            if (mentionsMultipleCompetitors) {
                score4 += 3;
            } else {
                score4 += 1;
            }

            // Competitive advantage (5 points)
            const advantageWords = countWords(competitiveAdvantage);
            const hasAdvantageKeywords = hasKeywords(competitiveAdvantage, ANSWER_KEY.requiredKeywords.competitiveAdvantage, 2);
            if (advantageWords >= 150 && hasAdvantageKeywords) {
                score4 += 5;
            } else if (advantageWords >= 100) {
                score4 += 3;
            } else {
                score4 += 1;
                feedback.push({
                    type: 'warning',
                    message: 'Competitive advantage analysis should be more comprehensive and reference PayFlow\'s differentiation.'
                });
            }

            // Competitive threats (3 points)
            if (countWords(competitiveThreats) >= 75) {
                score4 += 3;
            } else if (countWords(competitiveThreats) >= 40) {
                score4 += 2;
            }

            // SECTION 5: Strategic Framework (25 points)
            const thesis = document.getElementById('thesis')?.value || '';
            const gtmStrategy = document.getElementById('gtmStrategy')?.value || '';
            const riskMitigation = document.getElementById('riskMitigation')?.value || '';
            const recommendation = document.getElementById('recommendation')?.value || '';
            const rationale = document.getElementById('rationale')?.value || '';
            const investmentConditions = document.getElementById('investmentConditions')?.value || '';

            // Investment thesis (10 points)
            const thesisWords = countWords(thesis);
            if (thesisWords >= 200) {
                const synthesizes = (thesis.toLowerCase().includes('market') &&
                                   thesis.toLowerCase().includes('compet') &&
                                   (thesis.toLowerCase().includes('financial') || thesis.toLowerCase().includes('metric')));
                if (synthesizes) {
                    score5 += 10;
                } else {
                    score5 += 6;
                    feedback.push({
                        type: 'warning',
                        message: 'Investment thesis should synthesize market, competitive, and financial insights.'
                    });
                }
            } else if (thesisWords >= 100) {
                score5 += 4;
                feedback.push({
                    type: 'warning',
                    message: `Investment thesis too brief (${thesisWords} words). Need 200+ words for comprehensive thesis.`
                });
            } else {
                score5 += 1;
            }

            // Risk mitigation (7 points)
            const riskWords = countWords(riskMitigation);
            if (riskWords >= 200) {
                const hasRiskStructure = (riskMitigation.toLowerCase().includes('risk') &&
                                        riskMitigation.toLowerCase().includes('mitigat'));
                if (hasRiskStructure) {
                    score5 += 7;
                } else {
                    score5 += 4;
                }
            } else if (riskWords >= 100) {
                score5 += 3;
            }

            // Recommendation rationale (8 points)
            const rationaleWords = countWords(rationale);
            if (recommendation && rationaleWords >= 250) {
                const datadriven = /\$|%|\d+/.test(rationale);
                if (datadriven) {
                    score5 += 8;
                } else {
                    score5 += 5;
                    feedback.push({
                        type: 'warning',
                        message: 'Investment rationale should reference specific data points and metrics from your analysis.'
                    });
                }
            } else if (rationaleWords >= 150) {
                score5 += 4;
            } else {
                score5 += 1;
                feedback.push({
                    type: 'warning',
                    message: 'Investment rationale needs more depth and data-driven justification.'
                });
            }

            const totalScore = score1 + score2 + score3 + score4 + score5;

            // Calculate LTV:CAC for final feedback
            const finalLtvCac = ltv / cac;

            // Overall performance feedback
            if (totalScore >= 90) {
                feedback.unshift({
                    type: 'success',
                    message: `Outstanding work! You demonstrated excellent analytical skills with ${totalScore}/100 points. Your analysis was data-driven, accurate, and comprehensive. This is institutional-grade venture diligence.`
                });
            } else if (totalScore >= 80) {
                feedback.unshift({
                    type: 'success',
                    message: `Strong performance with ${totalScore}/100 points. Your analysis was thorough and mostly accurate. Minor improvements in data extraction or depth would make this excellent.`
                });
            } else if (totalScore >= 70) {
                feedback.unshift({
                    type: 'success',
                    message: `Good work with ${totalScore}/100 points. You covered key areas but some data points were incorrect or analysis lacked depth. Review the materials more carefully.`
                });
            } else if (totalScore >= 60) {
                feedback.unshift({
                    type: 'warning',
                    message: `Adequate effort with ${totalScore}/100 points, but significant gaps in accuracy. VC diligence requires precise data extraction and thorough analysis. Review the materials and try again.`
                });
            } else if (totalScore >= 40) {
                feedback.unshift({
                    type: 'warning',
                    message: `Below expectations with ${totalScore}/100 points. Many critical data points were missed or incorrect. Carefully review all materials and ensure you're extracting specific facts and figures.`
                });
            } else {
                feedback.unshift({
                    type: 'error',
                    message: `Significant gaps in your analysis (${totalScore}/100 points). Return to the materials and extract specific data points. VC diligence requires accuracy and thoroughness.`
                });
            }

            // Update UI
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('score1').textContent = `${score1}/20`;
            document.getElementById('score2').textContent = `${score2}/25`;
            document.getElementById('score3').textContent = `${score3}/15`;
            document.getElementById('score4').textContent = `${score4}/15`;
            document.getElementById('score5').textContent = `${score5}/25`;

            // Display feedback
            const feedbackContainer = document.getElementById('feedbackContainer');
            feedbackContainer.innerHTML = feedback.map(f => 
                `<div class="feedback-box ${f.type}">${f.message}</div>`
            ).join('');

            // Add recommendation badge if provided
            if (recommendation) {
                const badge = `<div class="recommendation-badge ${recommendation}">
                    Your Recommendation: ${recommendation.toUpperCase()}
                </div>`;
                feedbackContainer.innerHTML = badge + feedbackContainer.innerHTML;
            }
        }

        function generateReport() {
            const data = {
                timestamp: new Date().toLocaleString(),
                scores: {
                    total: document.getElementById('totalScore').textContent,
                    marketAnalysis: document.getElementById('score1').textContent,
                    financialAnalysis: document.getElementById('score2').textContent,
                    customerInsights: document.getElementById('score3').textContent,
                    competitiveAnalysis: document.getElementById('score4').textContent,
                    strategicThinking: document.getElementById('score5').textContent
                },
                answers: {
                    tam: document.getElementById('tamValue')?.value,
                    sam: document.getElementById('samValue')?.value,
                    cagr: document.getElementById('cagr')?.value,
                    cac: document.getElementById('cac')?.value,
                    ltv: document.getElementById('ltv')?.value,
                    burnRate: document.getElementById('burnRate')?.value,
                    runway: document.getElementById('runway')?.value,
                    recommendation: document.getElementById('recommendation')?.value,
                    thesis: document.getElementById('thesis')?.value,
                    rationale: document.getElementById('rationale')?.value
                }
            };

            const reportContent = `
VENTURE CAPITAL SIMULATION - DETAILED REPORT
PayFlow Investment Analysis
Generated: ${data.timestamp}

═══════════════════════════════════════════════════════════════

PERFORMANCE SUMMARY
═══════════════════════════════════════════════════════════════

Overall Score: ${data.scores.total}

Breakdown by Section:
- Market Analysis Accuracy: ${data.scores.marketAnalysis}
- Financial Analysis Accuracy: ${data.scores.financialAnalysis}
- Customer Insights Extraction: ${data.scores.customerInsights}
- Competitive Analysis: ${data.scores.competitiveAnalysis}
- Strategic Thinking & Synthesis: ${data.scores.strategicThinking}

═══════════════════════════════════════════════════════════════

YOUR ANALYSIS
═══════════════════════════════════════════════════════════════

Market Sizing:
- TAM: $${data.answers.tam}B (Correct: $${ANSWER_KEY.tam}B)
- SAM: $${data.answers.sam}B (Correct: $${ANSWER_KEY.sam}B)
- CAGR: ${data.answers.cagr}% (Correct: ${ANSWER_KEY.cagr}%)

Financial Metrics:
- CAC: $${data.answers.cac} (Correct: $${ANSWER_KEY.cac})
- LTV: $${data.answers.ltv} (Correct: $${ANSWER_KEY.ltv})
- Burn Rate: $${data.answers.burnRate}/mo (Correct: $${ANSWER_KEY.burnRate}/mo)
- Runway: ${data.answers.runway} months (Correct: ${ANSWER_KEY.runway} months)

Investment Decision: ${data.answers.recommendation?.toUpperCase() || 'Not provided'}

═══════════════════════════════════════════════════════════════

INVESTMENT THESIS
═══════════════════════════════════════════════════════════════

${data.answers.thesis || 'Not provided'}

═══════════════════════════════════════════════════════════════

DECISION RATIONALE
═══════════════════════════════════════════════════════════════

${data.answers.rationale || 'Not provided'}

═══════════════════════════════════════════════════════════════

This report was generated by the Cloverpath VC Simulation Module.
For educational purposes only.
            `;

            const blob = new Blob([reportContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `PayFlow_Analysis_Report_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetSimulation() {
            if (confirm('Are you sure you want to start a new analysis? All current data will be lost.')) {
                location.reload();
            }
        }

        function sendHeightToParent() {
            try {
                const height = document.body.scrollHeight + 100;
                window.parent.postMessage({
                    type: 'iframe-height',
                    height: height
                }, '*');
            } catch (e) {
                console.error('Error sending height:', e);
            }
        }
        
        window.addEventListener('load', function() {
            setTimeout(sendHeightToParent, 500);
            setTimeout(sendHeightToParent, 1500);
        });

        initSupabase();
    </script>
    
    <div id="content-end-marker" style="height: 1px; margin: 0; padding: 0;"></div>
</body>
</html>
